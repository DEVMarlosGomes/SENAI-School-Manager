{% extends 'base.html' %}
{% load static %}

{% block title %}Secretaria - Visão Geral{% endblock %}

{% block content %}
<div class="layout-wrapper d-flex">
    {% include 'includes/sidebar.html' %}
    
    <div id="main-content" class="flex-grow-1 transition-all">
        <header class="header-modern sticky-top shadow-sm py-3 px-4">
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center gap-3">
                    <button class="btn btn-light d-md-none shadow-sm" id="sidebarToggle"><i class="fas fa-bars"></i></button>
                    <div>
                        <div class="header-breadcrumb"><i class="fas fa-university me-1"></i> Secretaria Acadêmica</div>
                        <h1 class="header-title mb-0">Visão Geral</h1>
                    </div>
                </div>
                <div class="d-flex align-items-center gap-3">
                    <div class="d-none d-lg-block text-end me-2">
                        <small class="text-muted d-block" style="font-size: 0.7rem;">HOJE</small>
                        <span class="fw-bold text-dark small">{% now "d \d\e F \d\e Y" %}</span>
                    </div>
                    <div class="header-profile-box d-flex align-items-center gap-3 cursor-pointer">
                        <div class="text-end d-none d-sm-block" style="line-height: 1.1;">
                            <p class="mb-0 fw-bold text-dark small">{{ user.first_name|default:'Usuário' }}</p>
                            <p class="mb-0 text-muted" style="font-size: 0.7rem;">Secretaria</p>
                        </div>
                        <div class="rounded-circle bg-white d-flex align-items-center justify-content-center shadow-sm" style="width: 38px; height: 38px; border: 2px solid var(--primary-color);">
                            <i class="fas fa-user text-senai-red"></i>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div class="container-fluid p-4">
            <div class="bg-white p-4 rounded-3 shadow-sm mb-4 border-start border-4 border-senai-red">
                <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
                    <div>
                        <h4 class="fw-bold text-dark mb-1">Bem-vindo(a) de volta!</h4>
                        <p class="text-muted mb-0 small">Você tem <span class="fw-bold text-danger">8 pendências</span> que requerem sua atenção hoje.</p>
                    </div>
                    <div class="d-flex gap-2">
                        <a href="{% url 'relatorio_secretaria_pdf' user.id %}" class="btn btn-outline-danger btn-sm" target="_blank">
                            <i class="fas fa-file-pdf me-2"></i>Relatório PDF
                        </a>
                    </div>
                </div>
            </div>

            <div class="row g-3 mb-4">
                <div class="col-lg-4 col-md-6">
                    <div class="card p-3 border-0 shadow-sm h-100 bg-primary-subtle">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-primary small text-uppercase fw-bold mb-1">Novos Alunos</h6>
                                <h2 class="display-6 fw-bold text-primary mb-0">24</h2>
                            </div>
                            <div class="bg-white p-3 rounded-circle shadow-sm">
                                <i class="fas fa-user-plus fa-lg text-primary"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="card p-3 border-0 shadow-sm h-100 bg-warning-subtle">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-warning-emphasis small text-uppercase fw-bold mb-1">Pendências</h6>
                                <h2 class="display-6 fw-bold text-warning-emphasis mb-0">8</h2>
                            </div>
                            <div class="bg-white p-3 rounded-circle shadow-sm">
                                <i class="fas fa-exclamation-circle fa-lg text-warning"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="card p-3 border-0 shadow-sm h-100 bg-success-subtle">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-success small text-uppercase fw-bold mb-1">Confirmadas</h6>
                                <h2 class="display-6 fw-bold text-success mb-0">156</h2>
                            </div>
                            <div class="bg-white p-3 rounded-circle shadow-sm">
                                <i class="fas fa-check-circle fa-lg text-success"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <h6 class="mb-3 fw-bold text-muted text-uppercase small ls-1">Módulos de Gestão</h6>
            <div class="row g-4">
                <div class="col-lg-3 col-md-6">
                    <a href="{% url 'gestao_alunos' %}" class="card text-decoration-none border-0 shadow-sm h-100 hover-elevate">
                        <div class="card-body text-center p-4">
                            <div class="mb-3 d-inline-flex align-items-center justify-content-center bg-light-primary text-primary rounded-circle" style="width: 64px; height: 64px;">
                                <i class="fas fa-user-graduate fa-2x"></i>
                            </div>
                            <h6 class="fw-bold text-dark mb-1">Gestão de Alunos</h6>
                            <small class="text-muted">Matrículas e cadastros</small>
                        </div>
                    </a>
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <a href="{% url 'controle_financeiro' %}" class="card text-decoration-none border-0 shadow-sm h-100 hover-elevate">
                        <div class="card-body text-center p-4">
                            <div class="mb-3 d-inline-flex align-items-center justify-content-center bg-light-success text-success rounded-circle" style="width: 64px; height: 64px;">
                                <i class="fas fa-dollar-sign fa-2x"></i>
                            </div>
                            <h6 class="fw-bold text-dark mb-1">Financeiro</h6>
                            <small class="text-muted">Pagamentos e inadimplência</small>
                        </div>
                    </a>
                </div>

                <div class="col-lg-3 col-md-6">
                    <a href="{% url 'gestao_documentos' %}" class="card text-decoration-none border-0 shadow-sm h-100 hover-elevate">
                        <div class="card-body text-center p-4">
                            <div class="mb-3 d-inline-flex align-items-center justify-content-center bg-light-warning text-warning rounded-circle" style="width: 64px; height: 64px;">
                                <i class="fas fa-file-alt fa-2x"></i>
                            </div>
                            <h6 class="fw-bold text-dark mb-1">Documentos</h6>
                            <small class="text-muted">Emissão e histórico</small>
                        </div>
                    </a>
                </div>

                <div class="col-lg-3 col-md-6">
                    <a href="{% url 'comunicacao_secretaria' %}" class="card text-decoration-none border-0 shadow-sm h-100 hover-elevate">
                        <div class="card-body text-center p-4">
                            <div class="mb-3 d-inline-flex align-items-center justify-content-center bg-light-danger text-senai-red rounded-circle" style="width: 64px; height: 64px;">
                                <i class="fas fa-comments fa-2x"></i>
                            </div>
                            <h6 class="fw-bold text-dark mb-1">Comunicação</h6>
                            <small class="text-muted">Mural e avisos</small>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Pequeno ajuste para cards ficarem bonitos */
    .hover-elevate { transition: transform 0.2s, box-shadow 0.2s; }
    .hover-elevate:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important; }
    .bg-light-primary { background-color: rgba(13, 110, 253, 0.1); }
    .bg-light-success { background-color: rgba(25, 135, 84, 0.1); }
    .bg-light-warning { background-color: rgba(255, 193, 7, 0.1); }
    .bg-light-danger { background-color: rgba(255, 0, 0, 0.1); }
    .ls-1 { letter-spacing: 1px; }
</style>

<div class="overlay"></div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Toggle Sidebar
        const sidebar = document.getElementById('sidebar');
        const sidebarCollapse = document.getElementById('sidebarToggle');
        const overlay = document.querySelector('.overlay');
        if(sidebarCollapse) {
            sidebarCollapse.addEventListener('click', () => {
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
            });
            overlay.addEventListener('click', () => {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            });
        }
    });
</script>
{% endblock %}