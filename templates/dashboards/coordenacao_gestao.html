{% extends 'base.html' %}
{% load static %}

{% block title %}Coordenação - Gestão Acadêmica{% endblock %}

{% block content %}
<div class="layout-wrapper d-flex bg-white" style="height: 100vh; overflow: hidden;">
    {% include 'includes/sidebar.html' %}
    
    <div id="main-content" class="flex-grow-1 d-flex flex-column">
        <header class="bg-white border-bottom py-3 px-4 flex-shrink-0">
             <div class="d-flex justify-content-between align-items-center">
                 <div class="d-flex align-items-center gap-3">
                    <div class="bg-primary bg-opacity-10 p-2 rounded-3 text-primary">
                        <i class="fas fa-database fa-lg"></i>
                    </div>
                    <div>
                        <h5 class="fw-bold text-dark mb-0">Gestão de Registros</h5>
                        <small class="text-muted">Controle administrativo do SENAI School</small>
                    </div>
                </div>
                
                <div class="d-flex gap-2">
                     <a href="{% url 'coordenacao_aprovacao' %}" class="btn btn-warning text-dark d-flex align-items-center gap-2 shadow-sm">
                        <i class="fas fa-user-check"></i>
                        <span class="d-none d-sm-inline">Aprovações Pendentes</span>
                     </a>
                </div>
            </div>
        </header>

        <div class="flex-grow-1 d-flex overflow-hidden">
             <aside class="w-25 bg-light border-end d-none d-lg-flex flex-column p-3 overflow-auto" style="min-width: 250px; max-width: 300px;">
                <div class="nav flex-column nav-pills gap-1" id="v-pills-tab" role="tablist">
                    <button class="nav-link active d-flex align-items-center px-3 py-2 mb-1" data-bs-toggle="pill" data-bs-target="#v-pills-alunos">
                        <i class="fas fa-user-graduate me-2"></i> Alunos
                    </button>
                    <button class="nav-link d-flex align-items-center px-3 py-2 mb-1" data-bs-toggle="pill" data-bs-target="#v-pills-turmas">
                        <i class="fas fa-users me-2"></i> Turmas
                    </button>
                    <button class="nav-link d-flex align-items-center px-3 py-2 mb-1" data-bs-toggle="pill" data-bs-target="#v-pills-professores">
                        <i class="fas fa-chalkboard-teacher me-2"></i> Professores
                    </button>
                    <button class="nav-link d-flex align-items-center px-3 py-2 mb-1" data-bs-toggle="pill" data-bs-target="#v-pills-disciplinas">
                        <i class="fas fa-book me-2"></i> Disciplinas
                    </button>
                </div>
            </aside>

            <main class="flex-grow-1 bg-white p-0 d-flex flex-column h-100 overflow-hidden position-relative">
                <div class="tab-content flex-grow-1 overflow-auto p-0" id="v-pills-tabContent">
                    
                    <div class="tab-pane fade show active h-100" id="v-pills-alunos" role="tabpanel">
                        <div class="p-3 border-bottom bg-light d-flex justify-content-between">
                             <h6 class="mb-0 lh-base fw-bold text-muted">Catálogo de Alunos</h6>
                             <button class="btn btn-sm btn-success" id="btnNovoAluno"><i class="fas fa-plus me-1"></i> Novo Aluno</button>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0 custom-table" id="tableAlunos">
                                <thead class="bg-white sticky-top border-bottom">
                                    <tr>
                                        <th class="ps-4">Nome</th>
                                        <th>Matrícula</th>
                                        <th>Turma</th>
                                        <th>Status</th>
                                        <th class="text-end pe-4">Ação</th>
                                    </tr>
                                </thead>
                                <tbody id="alunosTableBody">
                                    </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-pane fade h-100" id="v-pills-turmas" role="tabpanel">
                        <div class="p-3 border-bottom bg-light d-flex justify-content-between">
                             <h6 class="mb-0 lh-base fw-bold text-muted">Catálogo de Turmas</h6>
                             <button class="btn btn-sm btn-success" id="btnNovaTurma"><i class="fas fa-plus me-1"></i> Nova Turma</button>
                        </div>
                        <div class="p-3 row g-3" id="turmasContainer">
                            </div>
                    </div>

                    <div class="tab-pane fade h-100" id="v-pills-professores" role="tabpanel">
                        <div class="p-3 border-bottom bg-light d-flex justify-content-between">
                             <h6 class="mb-0 lh-base fw-bold text-muted">Corpo Docente</h6>
                             <button class="btn btn-sm btn-success" id="btnNovoProfessor"><i class="fas fa-plus me-1"></i> Novo Professor</button>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0 custom-table">
                                <thead class="bg-white sticky-top border-bottom">
                                    <tr>
                                        <th class="ps-4">Nome</th>
                                        <th>E-mail</th>
                                        <th>Registro</th>
                                        <th>Turmas</th>
                                        <th class="text-end pe-4">Ação</th>
                                    </tr>
                                </thead>
                                <tbody id="professoresTableBody"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-pane fade h-100" id="v-pills-disciplinas" role="tabpanel">
                         <div class="p-3 border-bottom bg-light d-flex justify-content-between">
                             <h6 class="mb-0 lh-base fw-bold text-muted">Matriz Curricular</h6>
                             <button class="btn btn-sm btn-success" id="btnNovaDisciplina"><i class="fas fa-plus me-1"></i> Nova Disciplina</button>
                        </div>
                         <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0 custom-table">
                                <thead class="bg-white sticky-top border-bottom">
                                    <tr>
                                        <th class="ps-4">Código</th>
                                        <th>Nome</th>
                                        <th>Carga Horária</th>
                                        <th class="text-end pe-4">Ação</th>
                                    </tr>
                                </thead>
                                <tbody id="disciplinasTableBody"></tbody>
                            </table>
                        </div>
                    </div>

                </div>
            </main>
        </div>
    </div>
</div>

<div class="modal fade" id="modalAluno" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalAlunoTitle">Novo Aluno</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formAluno">
                    <div class="mb-3">
                        <label class="form-label">Nome Completo</label>
                        <input type="text" class="form-control" id="inputAlunoNome" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">E-mail</label>
                        <input type="email" class="form-control" id="inputAlunoEmail" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Matrícula (RA)</label>
                        <input type="text" class="form-control" id="inputAlunoMatricula" required>
                    </div>
                    <div class="row">
                        <div class="col-6 mb-3">
                            <label class="form-label">Turma</label>
                            <select class="form-select" id="inputAlunoTurma">
                                <option value="">Selecione...</option>
                            </select>
                        </div>
                        <div class="col-6 mb-3">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="inputAlunoStatus">
                                <option value="Ativo">Ativo</option>
                                <option value="Trancado">Trancado</option>
                                <option value="Cancelado">Cancelado</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="btnSalvarAluno">Salvar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalTurma" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTurmaTitle">Nova Turma</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formTurma">
                    <div class="mb-3">
                        <label class="form-label">Código da Turma</label>
                        <input type="text" class="form-control" id="inputTurmaCodigo" placeholder="Ex: 1DS-M" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Curso</label>
                        <select class="form-select" id="inputTurmaCurso" required>
                            <option value="">Selecione...</option>
                        </select>
                    </div>
                    <div class="row">
                        <div class="col-6 mb-3">
                            <label class="form-label">Data Início</label>
                            <input type="date" class="form-control" id="inputTurmaInicio">
                        </div>
                        <div class="col-6 mb-3">
                            <label class="form-label">Data Fim</label>
                            <input type="date" class="form-control" id="inputTurmaFim">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Vagas</label>
                        <input type="number" class="form-control" id="inputTurmaVagas" value="40">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="btnSalvarTurma">Salvar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalProfessor" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalProfessorTitle">Novo Professor</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formProfessor">
                    <div class="mb-3">
                        <label class="form-label">Nome Completo</label>
                        <input type="text" class="form-control" id="inputProfNome" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">E-mail</label>
                        <input type="email" class="form-control" id="inputProfEmail" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Registro Funcional</label>
                        <input type="text" class="form-control" id="inputProfRegistro">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="btnSalvarProfessor">Salvar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalDisciplina" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalDisciplinaTitle">Nova Disciplina</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formDisciplina">
                    <div class="mb-3">
                        <label class="form-label">Código</label>
                        <input type="text" class="form-control" id="inputDiscCodigo" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Nome da Disciplina</label>
                        <input type="text" class="form-control" id="inputDiscNome" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Carga Horária (horas)</label>
                        <input type="number" class="form-control" id="inputDiscCH">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="btnSalvarDisciplina">Salvar</button>
            </div>
        </div>
    </div>
</div>

{% csrf_token %}

{% endblock %}

{% block extra_js %}
<script>
    window.SCHOOL_DATA = {
        alunos: {{ alunos_json|safe }},
        turmas: {{ turmas_json|safe }},
        professores: {{ professores_json|safe }},
        disciplinas: {{ disciplinas_json|safe }},
        cursos: {{ cursos_json|safe }}
    };
</script>

<script src="{% static 'js/coordenacao-gestao.js' %}"></script>
{% endblock %}